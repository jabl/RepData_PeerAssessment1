---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

The data is preprocessed such that the interval column is changed to be minutes into the day, meaning the value will be between 0 and 1435. Originally the interval is of the form "%H%M", so without preprocessing there would be jumps e.g. going from 155 to 200.


```{r}
if (!file.exists("activity.csv")) {
  unzip("activity.zip")
}
act <- read.csv("activity.csv", colClasses=c("numeric", "Date", "character"))
act$interval <- sapply(act[,3], function(x) {
  if (nchar(x) < 3) {
      as.integer(x)
  } else if (nchar(x) == 3) {
      as.integer(substr(x, 1, 1)) * 60 + as.integer(substr(x, 2, 3))
  } else {
      as.integer(substr(x, 1, 2)) * 60 + as.integer(substr(x, 3, 4))
  }
  })
```

## What is mean total number of steps taken per day?
```{r}
library(ggplot2)
steps <- tapply(act$steps, act$date, sum)
qplot(steps, binwidth=1000)
mean(steps, na.rm=TRUE)
median(steps, na.rm=TRUE)
```


## What is the average daily activity pattern?
```{r}
s <- split(act, act$interval)
s2 <- lapply(s, function(x) {
  data.frame(steps=mean(x$steps, na.rm=TRUE), interval=x$interval[1])
})
avg_daily <- do.call("rbind", s2)
qplot(interval, steps, data=avg_daily, geom="line")
max_int <- avg_daily$interval[which.max(avg_daily$steps)]
min2time <- function(x) {
  # Convert a "minutes since midnight" to hour:minute
  paste(as.character(floor(x/60)), ":", as.character(x%%60), sep="")
}
print(sprintf("Interval with maximum steps: %s - %s",
              min2time(max_int),
              min2time(max_int + 5)))
```


## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
